import{r as M,K as mt,a4 as U,a8 as vt,a2 as q,w as W,o as gt,z as A,g as it,a7 as Q,Z as B,a as pt,aC as xt,h as N,aE as bt,aF as yt,aG as wt,c as C,Y as Tt,v as Ht,as as Et,x as St,J as Ct}from"./index.d61041dd.js";import{c as G,a as Wt,b as Mt,u as Pt,d as Lt}from"./selection.0b5ca2bc.js";import{b as X,c as $t}from"./focus-manager.05708ea9.js";import{u as kt}from"./use-timeout.c2ca1712.js";import{c as qt,b as At}from"./scroll.d9a5e495.js";const zt={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function Dt({showing:t,avoidEmit:n,configureAnchorEl:l}){const{props:e,proxy:i,emit:u}=it(),o=M(null);let r=null;function d(a){return o.value===null?!1:a===void 0||a.touches===void 0||a.touches.length<=1}const s={};l===void 0&&(Object.assign(s,{hide(a){i.hide(a)},toggle(a){i.toggle(a),a.qAnchorHandled=!0},toggleKey(a){mt(a,13)===!0&&s.toggle(a)},contextClick(a){i.hide(a),U(a),vt(()=>{i.show(a),a.qAnchorHandled=!0})},prevent:U,mobileTouch(a){if(s.mobileCleanup(a),d(a)!==!0)return;i.hide(a),o.value.classList.add("non-selectable");const c=a.target;q(s,"anchor",[[c,"touchmove","mobileCleanup","passive"],[c,"touchend","mobileCleanup","passive"],[c,"touchcancel","mobileCleanup","passive"],[o.value,"contextmenu","prevent","notPassive"]]),r=setTimeout(()=>{r=null,i.show(a),a.qAnchorHandled=!0},300)},mobileCleanup(a){o.value.classList.remove("non-selectable"),r!==null&&(clearTimeout(r),r=null),t.value===!0&&a!==void 0&&G()}}),l=function(a=e.contextMenu){if(e.noParentEvent===!0||o.value===null)return;let c;a===!0?i.$q.platform.is.mobile===!0?c=[[o.value,"touchstart","mobileTouch","passive"]]:c=[[o.value,"mousedown","hide","passive"],[o.value,"contextmenu","contextClick","notPassive"]]:c=[[o.value,"click","toggle","passive"],[o.value,"keyup","toggleKey","passive"]],q(s,"anchor",c)});function h(){Q(s,"anchor")}function p(a){for(o.value=a;o.value.classList.contains("q-anchor--skip");)o.value=o.value.parentNode;l()}function x(){if(e.target===!1||e.target===""||i.$el.parentNode===null)o.value=null;else if(e.target===!0)p(i.$el.parentNode);else{let a=e.target;if(typeof e.target=="string")try{a=document.querySelector(e.target)}catch{a=void 0}a!=null?(o.value=a.$el||a,l()):(o.value=null,console.error(`Anchor: target "${e.target}" not found`))}}return W(()=>e.contextMenu,a=>{o.value!==null&&(h(),l(a))}),W(()=>e.target,()=>{o.value!==null&&h(),x()}),W(()=>e.noParentEvent,a=>{o.value!==null&&(a===!0?h():l())}),gt(()=>{x(),n!==!0&&e.modelValue===!0&&o.value===null&&u("update:modelValue",!1)}),A(()=>{r!==null&&clearTimeout(r),h()}),{anchorEl:o,canShow:d,anchorEvents:s}}function jt(t,n){const l=M(null);let e;function i(r,d){const s=`${d!==void 0?"add":"remove"}EventListener`,h=d!==void 0?d:e;r!==window&&r[s]("scroll",h,B.passive),window[s]("scroll",h,B.passive),e=d}function u(){l.value!==null&&(i(l.value),l.value=null)}const o=W(()=>t.noParentEvent,()=>{l.value!==null&&(u(),n())});return A(o),{localScrollTarget:l,unconfigureScrollTarget:u,changeScrollEvent:i}}const $=[];function Ot(t){for(t=t.parent;t!=null;){if(t.type.name==="QGlobalDialog")return!0;if(t.type.name==="QDialog"||t.type.name==="QMenu")return!1;t=t.parent}return!1}function Ft(t,n,l,e){const i=M(!1),u=M(!1);let o=null;const r={},d=e==="dialog"&&Ot(t);function s(p){if(p===!0){X(r),u.value=!0;return}u.value=!1,i.value===!1&&(d===!1&&o===null&&(o=yt(!1,e)),i.value=!0,$.push(t.proxy),$t(r))}function h(p){if(u.value=!1,p!==!0)return;X(r),i.value=!1;const x=$.indexOf(t.proxy);x!==-1&&$.splice(x,1),o!==null&&(wt(o),o=null)}return pt(()=>{h(!0)}),t.proxy.__qPortal=!0,xt(t.proxy,"contentEl",()=>n.value),{showPortal:s,hidePortal:h,portalIsActive:i,portalIsAccessible:u,renderPortal:()=>d===!0?l():i.value===!0?[N(bt,{to:o},l())]:void 0}}const Qt={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Bt(t,n=()=>{},l=()=>{}){return{transitionProps:C(()=>{const e=`q-transition--${t.transitionShow||n()}`,i=`q-transition--${t.transitionHide||l()}`;return{appear:!0,enterFromClass:`${e}-enter-from`,enterActiveClass:`${e}-enter-active`,enterToClass:`${e}-enter-to`,leaveFromClass:`${i}-leave-from`,leaveActiveClass:`${i}-leave-active`,leaveToClass:`${i}-leave-to`}}),transitionStyle:C(()=>`--q-transition-duration: ${t.transitionDuration}ms`)}}const{notPassiveCapture:z}=B,E=[];function D(t){const n=t.target;if(n===void 0||n.nodeType===8||n.classList.contains("no-pointer-events")===!0)return;let l=$.length-1;for(;l>=0;){const e=$[l].$;if(e.type.name==="QTooltip"){l--;continue}if(e.type.name!=="QDialog")break;if(e.props.seamless!==!0)return;l--}for(let e=E.length-1;e>=0;e--){const i=E[e];if((i.anchorEl.value===null||i.anchorEl.value.contains(n)===!1)&&(n===document.body||i.innerRef.value!==null&&i.innerRef.value.contains(n)===!1))t.qClickOutside=!0,i.onClickOutside(t);else return}}function Nt(t){E.push(t),E.length===1&&(document.addEventListener("mousedown",D,z),document.addEventListener("touchstart",D,z))}function J(t){const n=E.findIndex(l=>l===t);n!==-1&&(E.splice(n,1),E.length===0&&(document.removeEventListener("mousedown",D,z),document.removeEventListener("touchstart",D,z)))}let Z,tt;function et(t){const n=t.split(" ");return n.length!==2?!1:["top","center","bottom"].includes(n[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(n[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function Gt(t){return t?!(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number"):!0}const R={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(t=>{R[`${t}#ltr`]=t,R[`${t}#rtl`]=t});function nt(t,n){const l=t.split(" ");return{vertical:l[0],horizontal:R[`${l[1]}#${n===!0?"rtl":"ltr"}`]}}function Rt(t,n){let{top:l,left:e,right:i,bottom:u,width:o,height:r}=t.getBoundingClientRect();return n!==void 0&&(l-=n[1],e-=n[0],u+=n[1],i+=n[0],o+=n[0],r+=n[1]),{top:l,bottom:u,height:r,left:e,right:i,width:o,middle:e+(i-e)/2,center:l+(u-l)/2}}function It(t,n,l){let{top:e,left:i}=t.getBoundingClientRect();return e+=n.top,i+=n.left,l!==void 0&&(e+=l[1],i+=l[0]),{top:e,bottom:e+1,height:1,left:i,right:i+1,width:1,middle:i,center:e}}function Vt(t,n){return{top:0,center:n/2,bottom:n,left:0,middle:t/2,right:t}}function lt(t,n,l,e){return{top:t[l.vertical]-n[e.vertical],left:t[l.horizontal]-n[e.horizontal]}}function ot(t,n=0){if(t.targetEl===null||t.anchorEl===null||n>5)return;if(t.targetEl.offsetHeight===0||t.targetEl.offsetWidth===0){setTimeout(()=>{ot(t,n+1)},10);return}const{targetEl:l,offset:e,anchorEl:i,anchorOrigin:u,selfOrigin:o,absoluteOffset:r,fit:d,cover:s,maxHeight:h,maxWidth:p}=t;if(Tt.is.ios===!0&&window.visualViewport!==void 0){const S=document.body.style,{offsetLeft:g,offsetTop:b}=window.visualViewport;g!==Z&&(S.setProperty("--q-pe-left",g+"px"),Z=g),b!==tt&&(S.setProperty("--q-pe-top",b+"px"),tt=b)}const{scrollLeft:x,scrollTop:a}=l,c=r===void 0?Rt(i,s===!0?[0,0]:e):It(i,r,e);Object.assign(l.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:p||"100vw",maxHeight:h||"100vh",visibility:"visible"});const{offsetWidth:w,offsetHeight:P}=l,{elWidth:j,elHeight:k}=d===!0||s===!0?{elWidth:Math.max(c.width,w),elHeight:s===!0?Math.max(c.height,P):P}:{elWidth:w,elHeight:P};let v={maxWidth:p,maxHeight:h};(d===!0||s===!0)&&(v.minWidth=c.width+"px",s===!0&&(v.minHeight=c.height+"px")),Object.assign(l.style,v);const T=Vt(j,k);let f=lt(c,T,u,o);if(r===void 0||e===void 0)F(f,c,T,u,o);else{const{top:S,left:g}=f;F(f,c,T,u,o);let b=!1;if(f.top!==S){b=!0;const y=2*e[1];c.center=c.top-=y,c.bottom-=y+2}if(f.left!==g){b=!0;const y=2*e[0];c.middle=c.left-=y,c.right-=y+2}b===!0&&(f=lt(c,T,u,o),F(f,c,T,u,o))}v={top:f.top+"px",left:f.left+"px"},f.maxHeight!==void 0&&(v.maxHeight=f.maxHeight+"px",c.height>f.maxHeight&&(v.minHeight=v.maxHeight)),f.maxWidth!==void 0&&(v.maxWidth=f.maxWidth+"px",c.width>f.maxWidth&&(v.minWidth=v.maxWidth)),Object.assign(l.style,v),l.scrollTop!==a&&(l.scrollTop=a),l.scrollLeft!==x&&(l.scrollLeft=x)}function F(t,n,l,e,i){const u=l.bottom,o=l.right,r=qt(),d=window.innerHeight-r,s=document.body.clientWidth;if(t.top<0||t.top+u>d)if(i.vertical==="center")t.top=n[e.vertical]>d/2?Math.max(0,d-u):0,t.maxHeight=Math.min(u,d);else if(n[e.vertical]>d/2){const h=Math.min(d,e.vertical==="center"?n.center:e.vertical===i.vertical?n.bottom:n.top);t.maxHeight=Math.min(u,h),t.top=Math.max(0,h-u)}else t.top=Math.max(0,e.vertical==="center"?n.center:e.vertical===i.vertical?n.top:n.bottom),t.maxHeight=Math.min(u,d-t.top);if(t.left<0||t.left+o>s)if(t.maxWidth=Math.min(o,s),i.horizontal==="middle")t.left=n[e.horizontal]>s/2?Math.max(0,s-o):0;else if(n[e.horizontal]>s/2){const h=Math.min(s,e.horizontal==="middle"?n.middle:e.horizontal===i.horizontal?n.right:n.left);t.maxWidth=Math.min(o,h),t.left=Math.max(0,h-t.maxWidth)}else t.left=Math.max(0,e.horizontal==="middle"?n.middle:e.horizontal===i.horizontal?n.left:n.right),t.maxWidth=Math.min(o,s-t.left)}var Jt=Ht({name:"QTooltip",inheritAttrs:!1,props:{...zt,...Wt,...Qt,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:et},self:{type:String,default:"top middle",validator:et},offset:{type:Array,default:()=>[14,14],validator:Gt},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...Mt],setup(t,{slots:n,emit:l,attrs:e}){let i,u;const o=it(),{proxy:{$q:r}}=o,d=M(null),s=M(!1),h=C(()=>nt(t.anchor,r.lang.rtl)),p=C(()=>nt(t.self,r.lang.rtl)),x=C(()=>t.persistent!==!0),{registerTick:a,removeTick:c}=Pt(),{registerTimeout:w}=kt(),{transitionProps:P,transitionStyle:j}=Bt(t),{localScrollTarget:k,changeScrollEvent:v,unconfigureScrollTarget:T}=jt(t,_),{anchorEl:f,canShow:S,anchorEvents:g}=Dt({showing:s,configureAnchorEl:dt}),{show:b,hide:y}=Lt({showing:s,canShow:S,handleShow:rt,handleHide:ut,hideOnRouteChange:x,processOnMount:!0});Object.assign(g,{delayShow:st,delayHide:ct});const{showPortal:I,hidePortal:V,renderPortal:at}=Ft(o,d,ht,"tooltip");if(r.platform.is.mobile===!0){const m={anchorEl:f,innerRef:d,onClickOutside(H){return y(H),H.target.classList.contains("q-dialog__backdrop")&&Ct(H),!0}},O=C(()=>t.modelValue===null&&t.persistent!==!0&&s.value===!0);W(O,H=>{(H===!0?Nt:J)(m)}),A(()=>{J(m)})}function rt(m){I(),a(()=>{u=new MutationObserver(()=>L()),u.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),L(),_()}),i===void 0&&(i=W(()=>r.screen.width+"|"+r.screen.height+"|"+t.self+"|"+t.anchor+"|"+r.lang.rtl,L)),w(()=>{I(!0),l("show",m)},t.transitionDuration)}function ut(m){c(),V(),K(),w(()=>{V(!0),l("hide",m)},t.transitionDuration)}function K(){u!==void 0&&(u.disconnect(),u=void 0),i!==void 0&&(i(),i=void 0),T(),Q(g,"tooltipTemp")}function L(){ot({targetEl:d.value,offset:t.offset,anchorEl:f.value,anchorOrigin:h.value,selfOrigin:p.value,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function st(m){if(r.platform.is.mobile===!0){G(),document.body.classList.add("non-selectable");const O=f.value,H=["touchmove","touchcancel","touchend","click"].map(Y=>[O,Y,"delayHide","passiveCapture"]);q(g,"tooltipTemp",H)}w(()=>{b(m)},t.delay)}function ct(m){r.platform.is.mobile===!0&&(Q(g,"tooltipTemp"),G(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),w(()=>{y(m)},t.hideDelay)}function dt(){if(t.noParentEvent===!0||f.value===null)return;const m=r.platform.is.mobile===!0?[[f.value,"touchstart","delayShow","passive"]]:[[f.value,"mouseenter","delayShow","passive"],[f.value,"mouseleave","delayHide","passive"]];q(g,"anchor",m)}function _(){if(f.value!==null||t.scrollTarget!==void 0){k.value=At(f.value,t.scrollTarget);const m=t.noParentEvent===!0?L:y;v(k.value,m)}}function ft(){return s.value===!0?N("div",{...e,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",e.class],style:[e.style,j.value],role:"tooltip"},St(n.default)):null}function ht(){return N(Et,P.value,ft)}return A(K),Object.assign(o.proxy,{updatePosition:L}),at}});export{Jt as Q};
